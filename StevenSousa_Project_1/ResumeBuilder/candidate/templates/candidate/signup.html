<!-- candidate/templates/candidate/signup_step.html -->
{% extends 'base.html' %}
{% load static %}

{% block title %}Signup - Step {{ wizard.steps.step1 }} of {{ wizard.steps.count }}{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'candidate/signup.css' %}">
{% endblock %}

{% block content %}
    <div class="container h-100 d-flex flex-column">
        <h1 class="mb-4 mt-4">Signup - Step {{ wizard.steps.step1 }} of {{ wizard.steps.count }}</h1>

        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">{{ message }}</div>
            {% endfor %}
        {% endif %}

        <form method="post" id="signup-form" class="flex-grow-1">
            {% csrf_token %}
            {{ wizard.management_form }}

            {% if step_name == 'candidate' %}
                <div class="form-section">
                    <h2>Candidate Info</h2>
                    {{ form.as_p }}
                </div>
            {% elif step_name == 'experience' %}
                <div class="form-section">
                    <h2>Experience</h2>
                    {{ form.management_form }}
                    <div id="experiences-forms" class="formset-container">
                        {% for subform in form %}
                            <div class="experiences-form">
                                {{ subform.as_p }}
                                {% if subform.can_delete %}
                                    <label><input type="checkbox" name="{{ subform.prefix }}-DELETE" class="form-check-input"> Delete</label>
                                {% endif %}
                            </div>
                        {% endfor %}
                    </div>
                    <button type="button" class="btn btn-primary mb-3" id="add-experience">Add Experience</button>
                    <div id="empty-experiences-form" class="hidden-form">
                        {{ form.empty_form.as_p }}
                    </div>
                </div>
            {% elif step_name == 'projects' %}
                <div class="form-section">
                    <h2>Projects</h2>
                    {{ form.management_form }}
                    <div id="projects-forms" class="formset-container">
                        {% for subform in form %}
                            <div class="projects-form">
                                {{ subform.as_p }}
                                {% if subform.can_delete %}
                                    <label><input type="checkbox" name="{{ subform.prefix }}-DELETE" class="form-check-input"> Delete</label>
                                {% endif %}
                            </div>
                        {% endfor %}
                    </div>
                    <button type="button" class="btn btn-primary mb-3" id="add-project">Add Project</button>
                    <div id="empty-projects-form" class="hidden-form">
                        {{ form.empty_form.as_p }}
                    </div>
                </div>
            {% elif step_name == 'references' %}
                <div class="form-section">
                    <h2>References</h2>
                    {{ form.management_form }}
                    <div id="references-forms" class="formset-container">
                        {% for subform in form %}
                            <div class="references-form">
                                {{ subform.as_p }}
                                {% if subform.can_delete %}
                                    <label><input type="checkbox" name="{{ subform.prefix }}-DELETE" class="form-check-input"> Delete</label>
                                {% endif %}
                            </div>
                        {% endfor %}
                    </div>
                    <button type="button" class="btn btn-primary mb-3" id="add-reference">Add Reference</button>
                    <div id="empty-references-form" class="hidden-form">
                        {{ form.empty_form.as_p }}
                    </div>
                </div>
            {% endif %}

            <div class="mt-3">
                {% if wizard.steps.prev %}
                    <button type="submit" name="wizard_goto_step" value="{{ wizard.steps.prev }}" class="btn btn-secondary">Previous</button>
                {% endif %}
                <button type="submit" class="btn btn-primary">{{ wizard.steps.next|default:"Submit" }}</button>
            </div>
        </form>
    </div>
{% endblock %}

{% block extra_js %}
    <script src="{% static 'candidate/signup.js' %}"></script>
{% endblock %}